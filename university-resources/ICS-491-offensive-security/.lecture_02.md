# Lecture 2 - SBOMs

#### Experiment
- Open Spotify
- Select profile on the top left
- Go to Third-party licenses in Settings
- Notes
    - There are so many licenses that you don't know, so you don't know what's in your software
    - How many times have you done `pip install` or `npm install`?
        - What's actually inside your packages?

#### Demo
- mallory `npm publish` malicious exec "coookie-jar"
- alice `npm install` "coookie-jar" instead of "cookie-jar"
- mallory steals alice's .env files and gets SQL host, username, and password
- This is a Supply Chain Attack

#### Supply Chain Attack
- Attackers abuse the good faith of users in an ecosystem
- Attackers know you're not thinking of dependencies
- You may not run `pip install malware`, but dependencies could
- Infecting one package and getting it distributed through different platforms, gets it copied and transmitted everywhere
- Always start upstream
- Basically, attacks coming from dependencies

#### Stage 1: Infiltration
- Attackers inject malicious code into package ecosystem
- Methods include:
    - Typosquatting: Name a similar package (Ex. nunpy vs numpy)
    - Compromise: Malicious code is injected int o a safe package or entire package is compromised

#### Stage 2: Exploitation
- Package is pulled into a dev environment
- Attackers may have access to a dev space
- Get access to tools for more complex attacks
- Living of the Land: Using tools available on a box for further malicious use

#### Stage 3: Distribution
- Developer unknowingly ships malicious code
- Attacker has access beyond the development environment
    - Also has access to end users

#### Solarwinds Supply Chain Attack
- Major software company that had an IT management software called Orion
- APT29 (Cozy Bear) RU State Actor gained access to Solarwinds's network and its build pipeline for Orion
- A compromised build of Orion with a backdoor called SUNBURST begins shipping out to customers
    - Solarwinds didn't know it was compromised
- December 2020, breach is disclosed
- 18,000 Solarwinds customers were impacted and installed a malicious update containing the SUNBURST backdoor

#### Log4j/Log4shell Supply Chain Attack
- Logging library used by almost all Java applications
- CVE-2021-44228 was discovered, it allowed attackers to perform Arbitrary Code Execution
- Anecdote from SWE at Vanguard, every piece of code had to be combed through, did not know if they were impacted by Log4j
- Transient dependencies
    - Dependencies of dependencies
    - Your software may not be using Log4j but one of your dependencies likely is

#### Software Transparency
- We need to know what's in our software
    - Attackers take advantage of murky dependency trees
    - Log4j was costly because we needed to manually check
    - Is there any way to check if dependencies are compromised?
- Manifest files
    - Catch all term for list of dependencies referenced by a package manager
    - Lists are a good start, but they aren't standardized
    - `requirements.txt` for python is different from `pom.xml`
    - Customers don't know how to read these files

#### Software Bill Of Materials (SBOM)
- Derived from manufacturing Bill of Materials
    - Everything down to screws has a manufacture number and can be tracked down to where it was made
    - Can this be done with software?
- Effectively a food label for code
- Software consumer can quickly look at this label and say I use or don't use this dependency
- Different BOM flavors 
    - HBOM - Hardware Bill of Materials
    - CBOM Cryptographic Bill of Materials
    - AI/ML-BOM - AI/ML Bill of Materials

#### Government SBOM Policy
- Ever since Solarwinds, Biden issued EO 14028 to improve Nation's cybersecurity
- Required SBOM for products sold to the government
- Also gave mandate for NTIA to produce a Minimum Elements of an SBOM guidelines
    - NTIA:
        - Data Fields - What the SBOM contains
        - Automation Support - Standardized format for automated generation and consumption
        - Practices and Processes - Operations of SBOm in practice
- 2023, Biden issues National Cybersecurity Strategy to reaffirm SBOM support
- 2025, CISA updates SBOM guidelines

#### SBOM Data Fields
- SBOM Author
- Software Producer
- Component Name
- Component Version
- Software Identifiers
- Component Hash
- License
- Dependency Relationship
- Tool Name
- Timestamp
- Generation Context

#### Vulnerability Exploitability Exchange
- Software components are static, vulnerabilities are not
- Is a companion document to an SBOM
- Used to explain whether a component is or isn't impacted by CVE or if it's been patched and why
- List of requirements to be implemented OpenVEX is an example of a standard implementing them

#### Dependency Track Demo
1. Download Syft
2. Clone a project of your choice, make sure it has a manifest file
3. Generate a CycloneDX SBOM Upload SBOM to dependency-track:8081