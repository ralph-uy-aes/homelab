# Chapter 7: Authentication - Module A: Authentication Factors

#### The AAA Process
- Identification: User claims an identity in the system, following steps are validated within the context of that identity
- Authentication: Verification of principal or user's identity using a password or ID card for example
- Authorization: Specifying the exact resources a specific authenticated user is allowed to access
- Accounting: Tracking the actions of an authenticated user for later review

#### Factors and Attributes
- Single-factor authentication:
    - Something you know
        - Knowledge factor
        - Passwords, PINs, challenge questions
    - Something you have
        - Possession factor
        - Physical key, ID badge
        - Any digital data a human can't memorize
    - Something you are
        - Inherence factor
        - Unique physical or behavioral characteristic
        - Fingerprint, voiceprint, signature
        - Biometrics are inherence elements based on personal physical characteristics
- Attributes
    - Additional factors not used as primary authentication factors, but strengthen other authentication and authorization processes
    - Location, CAPTCHA, chain of trust, personality traits

#### Multifactor Authentication (MFA)
- Knowledge factors are easily shared or guessed
- Possession factors can be stolen or duplicated
- Inherence factors can be falsified
- MFA with two or three factors is much stronger
    - ATM card + PIN = Possession + Knowledge

#### Password Best Practices
- NIST SP 800-63B Password Design Highlights
    - Minimum length of 8 characters, but allow very long passwords
        - Allow passwords with spaces and special characters
        - Length is more important than complexity
    - New passwords should be screened against a list of common and compromised passwords to prevent dictionary attacks
        - Should not include user's or service's details
    - User should be able to copy and paste into password fields
        - Especially from password managers
    - Passwords should not expire since it makes it harder for users to remember them and causes them to choose minor variants that are easy to crack
        - When users change passwords, they shouldn't reuse old ones

#### Passwordless Authentication
- Non-knowledge authentication
- Uses certificates or biometrics
- Facial recognition, public key, sign-in links
- Very convenient for users, no need to remember long passwords

#### Digital Credentials
- Static code/passphrase
    - PIN, password, or some data value that does not change
    - Not inherently more or less secure than passwords of the same complexity
    - Only count as 2FA when used with a possession or inherence factor
- Digital certificate
    - A file created and signed using cryptographic algorithms
    - Demonstrates that the principal presenting the public certificate also holds its private key
- One-time Password (OTP)
    - Single-use PIN or password valid for a single session, often random and cannot be stolen or reused
    - Has to be known to both the user and authenticator, challenging to create accurately
    - Can be generated independently on both ends by a sequential or time-based algorithm
        - Or generated by the authenticator and transmitted out-of-band via email or phone
- Authentication token
    - Token generator creates OTPs to be entered into an MFA prompt, two types:
        - Hard tokens: Physical devices, with an LCD to display token value
        - Soft tokens: Applications that generate OTPs
- Security key
    - Physical device that directly authenticates itself to a compatible system
    - Can be USB, dongle or some NFC device
    - Very secure, but supported by less applications than OTP
- Smart card
    - Digital authentication card with integrated circuits built-in
    - Can hold digital certificates, store temporary data, or perform cryptographic processing
    - Receive power from the reader
    - SIM cards and credit card chips

#### OTP Generation
- HMAC-based OTP (HOTP)
    - Moving factor is a counter shared by token and authenticator
    - Whenever a new OTP is needed, the token generates a cryptographic hash-based message authentication code from the stored password and counter, then it increments the counter
- Time-based OTP (TOTP)
    - Based on HOTP
    - Uses HMAC generated from a shared secret and moving factor
    - The moving factor is a timestamp, incrementation is automatic and more secure and reliable

#### Biometrics
- Fingerprint or palm scanners measure unique patterns in the human hand
- Retinal scanners measure blood vessels in the inside of the eye using infrared light
- Iris scanners measure patterns in the iris
- Facial recognition compares an image of the face against a known photo
- Voice recognition combines biometric and behavioral recognition to compare a human voice to a recorded sample
- Gait analysis measures body motions when a person walks, can be performed by cameras, floor mats, and accelerometers in mobile devices

#### Biometric Limitations
- False Rejection: Valid subject is rejected because the reader wasn't convinced of a match, impairs legitimate users and is more frequent when tolerances are tight
- False Acceptance: Invalid subject is granted access because the reader mistook it for a match, allows unauthorized access and is more frequent when tolerances are loose

#### Attestation
- Process that remotely demonstrates that an application or computer meets a security baseline and has not undergone any unauthorized changes, including tampering with security controls

#### Single Sign-on (SSO)
- Allows a user to sign in once to one of a group of mutually trusting services then seamlessly switches between services without being prompted to sign in again
    - Gmail, Youtube, etc... has this
    - Servers communicate through tokens and certificates to verify your identity without interrupting you
- Multiple independent services share authentication servers
    - Facebook Connect allows third-party websites to offer a Log In with Facebook option
    - More accurately called same sign-on

#### Federated Identities
- Authentication is based on trust relationships
- Transitive trust, if one party has explicit trust with two other parties, the two other parties can transitively trust each other
- Federated Identity Management (FIM) allows authentication systems to be shared across multiple systems or networks that share authentication standards, even if not directly associated with each other

Acr
- AAA - Authentication, Authorization, Accounting
- MFA - Multifactor Authentication
- OTP - One-time Password
- HOTP - HMAC-based OTP
- TOTP - Time-based OTP